<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	
	<title>文艺范, 就是这个范儿</title>
	<link rel="shortcut icon" href="img/KV34BOLEpn.png"/>
	<!-- css导入区域 -->
	<link rel="stylesheet" href="css/common.css">
	<link rel="stylesheet" href="css/zan.css">
	<link rel="stylesheet" href="css/paging.css">
	
</head>
<body>
	<!-- 头部 区域-->
	<div class="header-area">
		<div class="header">
			<div class="header-left">
				<a href="javascript:;">文艺范</a>
				<a href="javascript:;">招商加盟</a>
				<a href="javascript:;">IOS客户端</a>
				<a href="javascript:;">Android客户端</a>
				<a href="javascript:;">联系我们</a>
				<a href="javascript:;">
					<img class="header-phone" src="img/phone.png" alt="">
					4008-900-800
				</a>
			</div>
			<div class="header-right">
				<a href="collect.html">个人主页</a>
				<a href="./login.html" target="_blank" class="login">登录</a>
                <a href="./register.html" target="_blank" class="reg">注册</a>
			</div>
		</div>
	</div>
	<!-- navbar 区域 -->
	<div class="navbar-area">
		<div class="navbar">
			<div class="navbar-left">
				<div class="logo-mask">
					<div class="logo">
						<a href="index.html"><img src="img/logo.png" alt=""></a>
					</div>
				</div>
				<div class="change-city">
					<div class="city-logo"></div>
					<div class="city">
						<span>北京</span>
						<a href="http://www.vko.cn/sitemap/index.html">【切换城市】</a>
					</div>
				</div>
			</div>
			<div class="navbar-center">
				<a href="index.html" class="index-avtive">首页</a>
				<a href="read.html">阅读<span><img src="img/n.png" alt=""></span></a>
				<a href="music.html">音乐</a>
				<a href="movie.html">影视</a>
				<a href="shopping.html">商品</a>
			</div>
			<div class="navbar-right">
                <input id="search_inp" onchange="doChange()" type="text" placeholder="请输入查找的内容">
                <a href="search.html"><img onclick="doChange()" src="img/nav-search.png" alt=""></a>
            </div>
		</div>
	</div>
	<!-- 中间内容区域 -->
	<div class="body">
			<div class="body-content">
				<div class="content-top">
					<div class="content-user">
						<div class="content-user-top"><img src="img/tou.png" alt=""></div>
						<div class="content-user-bottom">
							<!-- <div class="user-info">
								<div class="user-name"><b>${item.name}</b></div>
								<div class="user-autograph">${item.name}</div>
							</div> -->
						</div>
					</div>
				</div>
				<div class="content-left">
					<div class="tab">
						<div class="btns">
							<button class="actv">收藏</button>
							<button>点赞</button>
							<button>评论</button>
						
						</div>
						<div class="dis">
							<div class="actv">	
								<div class="select">
									类型选择：
									<button class="active">阅读</button>
									<button>音乐</button>
									<button>影视</button>
								</div>
								<div class="select-content">
									<div class="select_nei active">
										<div class="active_1">
										</div>
										<div class="box1" id="box"></div>
									</div>
									
									<div class="select_nei">
										<div class="active_1">
										</div>
										<div class="box1" id="box-music"></div>
									</div>
									<div class="select_nei">
										<div class="movie">
										
										</div>
										<div class="box1" id="box-movie"></div>
									</div>
								</div>	
							</div>
							<div>	
								<div class="select-content">
									<div class="select_nei active">
										<div class="active">
											<div class="act-coo"> 
												<div class="coo-left">
													<img src="img/5948dfbb9b4c60001960c96d-0.png" alt="">
												</div>

												<div class="coo-right">
													<p><b>你是谁的谁</b></p>
													<p class="active">9.4万播放 评论 2017-09-19</p>
												</div>
											</div>
											<div class="act-coo"> 
												<div class="coo-left">
													<img src="img/5948dfbb9b4c60001960c96d-0.png" alt="">
												</div>

												<div class="coo-right">
													<p><b>你是谁的谁</b></p>
													<p class="active">9.4万播放 评论 2017-09-19</p>
												</div>
											</div>	
											<div class="act-coo"> 
												<div class="coo-left">
													<img src="img/5948dfbb9b4c60001960c96d-0.png" alt="">
												</div>

												<div class="coo-right">
													<p><b>你是谁的谁</b></p>
													<p class="active">9.4万播放 评论 2017-09-19</p>
												</div>
											</div>
											<div class="act-coo"> 
												<div class="coo-left">
													<img src="img/5948dfbb9b4c60001960c96d-0.png" alt="">
												</div>

												<div class="coo-right">
													<p><b>你是谁的谁</b></p>
													<p class="active">9.4万播放 评论 2017-09-19</p>
												</div>
											</div>			
										</div>
										<div class="box1" id="box"></div>
									</div>
									
								</div>	
							</div>
							<div>	
								<div class="select-content">
									<div class="select_nei active">
										<div class="active">
											<div class="act-coo"> 
												<div class="coo-left">
													<img src="img/5948dfbb9b4c60001960c96d-0.png" alt="">
												</div>

												<div class="coo-right">
													<p><b>我是你的好孩子</b></p>
													<p class="active">9.4万播放 评论 2017-09-19</p>
												</div>
											</div>
											<div class="act-coo"> 
												<div class="coo-left">
													<img src="img/5948dfbb9b4c60001960c96d-0.png" alt="">
												</div>

												<div class="coo-right">
													<p><b>我是你的好孩子</b></p>
													<p class="active">9.4万播放 评论 2017-09-19</p>
												</div>
											</div>	
											<div class="act-coo"> 
												<div class="coo-left">
													<img src="img/5948dfbb9b4c60001960c96d-0.png" alt="">
												</div>

												<div class="coo-right">
													<p><b>我是你的好孩子</b></p>
													<p class="active">9.4万播放 评论 2017-09-19</p>
												</div>
											</div>
											<div class="act-coo"> 
												<div class="coo-left">
													<img src="img/5948dfbb9b4c60001960c96d-0.png" alt="">
												</div>

												<div class="coo-right">
													<p><b>我是你的好孩子</b></p>
													<p class="active">9.4万播放 评论 2017-09-19</p>
												</div>
											</div>				
										</div>

										<div class="box1" id="box"></div>
									</div>
									
								</div>	
							</div>
						</div>
					</div>
				</div>
				<div class="content-right">

					<div class="content-right-title"><b>近期最佳文章</b></div>
					<div class="content-right-bottom">
						<div class="content-first">
						</div>						
					</div>
				</div>
			</div>
		</div>
	<!-- footer 区域 -->
	<div class="footer-area">
		<div class="footer">
			<div class="footer-title">文艺范</div>
			<div class="about">
				
				<a href="about.html">关于</a>|
				<a href="javascript:;">用户协议</a>|
				<a href="javascript:;">联系我们</a>
			</div>
			<div class="website-title">本站为文艺范官方网站</div>
			<div class="icp-title">浙ICP备1500041号</div>
		</div>
	</div>
	<!-- js导入 -->
	<script src="js/jquery.min.js"></script>
	<script src="js/paging.js"></script>
	<script src="js/interface.js"></script>
	<script src="js/common.js"></script>

	<script>


		//外面选项卡
		var btns = document.querySelectorAll('.btns button');
		var divs = document.querySelectorAll('.dis>div');

		for(var i=0; i<btns.length; i++){
			btns[i].index = i;
			btns[i].onclick=function(){
				for(var i=0; i<btns.length;i++){
					btns[i].className = "";
					divs[i].className = "";
				}
				this.className = "actv";
				divs[this.index].className = "actv";
			}
		}
		//里面选项卡
		var buttons = document.querySelectorAll('.select button');
		var dves = document.querySelectorAll('.select-content .select_nei');

		for(var i=0; i<btns.length; i++){
			buttons[i].index = i;
			buttons[i].onclick=function(){
				for(var i=0; i<btns.length;i++){
					buttons[i].className = "";
					dves[i].className = "";
				}
				this.className = "active";
				dves[this.index].className = "select_nei active";
			}
		}
		
		//ajax请求收藏-阅读数据
	
		var currentPage = 1;
		var pageCount = 0;
		var count = 4;
		function  downReadList(page){
			currentPage = page
			var user = JSON.parse(localStorage.user)
			// console.log(user)
			var url=getFavoriteUrl+"&userId="+user.id+"&type="+1+"&token="+localStorage.token+"&start="+(currentPage-1)*count+"&count="+count;
			// console.log(url)
			$.ajax({
				dataType:"json",
				url:url,
				success:function(data){
					// console.log(data)
					$(".select-content .active_1").eq(0).empty()
					for(item of data.data){
						var li = document.createElement('li');

						li.innerHTML =`
										
											<div id="${item.id}" class="act-coo"> 
											
													<div class="coo-left">
													<img src="${imagePrefix}${item.img_url}" alt="">
												</div>
												
												<div class="coo-right">
													<p><b>${item.hp_title}</b></p>
													<p class="active">评论:${item.like_count}</p>
													<p>时间:${item.post_date}</p>
													<p>${item.forward}</p>
												</div>
											
												
											</div>
											
											`;
						$(".select-content .active_1").eq(0).append(li);
					}
					pageCount = Math.ceil(data.total / count)
					//分页器
					$('#box').paging({
						initPageNo: currentPage, // 初始页码
						totalPages: pageCount, //总页数
						slideSpeed: 600, // 缓动速度。单位毫秒
						// jump: true, //是否支持跳转
						callback: function(page) { // 回调函数
							// var start = (this.page-1)*this.count
							console.log(page)
							if(currentPage == page){
								return
							}
							downReadList(page);
						}
					});
					//绑定id。跳转详情页面
					$(".act-coo").click(function(e){
						var id=e.currentTarget.id
						sessionStorage.id=id
						location.href="readDetail.html"
					})
				}
			});
			
		}

		downReadList(currentPage)


		
		//获取用户信息
		var user = JSON.parse(localStorage.user)
		console.log(user)
			var div = document.createElement('div');
			// var  = document.createElement('div');
						div.innerHTML =`
								<div class="content-user-bottom">
									<div class="small">
									 <a href="user.html"><img src="${imagePrefix}${user.image}"></img></a></div>
										
									
									<div class="user-info">
										<div class="user-name"><b>${user.username}</b></div>
										<div class="user-autograph">职业君，提供IT行业咨询，笔试面试题，职业分析与规划。</div>
									</div>
								</div>
											`;
						$(".content-user .content-user-bottom").eq(0).append(div);


		//ajax请求-音乐-数据
		var currentPage = 1;
		var pageCount = 0;
		var count = 4;
		function  downMusicList(page){
			currentPage = page
			var user = JSON.parse(localStorage.user)
			console.log(user)
			var url=getFavoriteUrl+"&userId="+user.id+"&type="+4+"&token="+localStorage.token+"&start="+(currentPage-1)*count+"&count="+count;

			$.ajax({
				dataType:"json",
				url:url,
				success:function(data){
					
					// $(".select-content .active_1").eq(1).empty()
					for(item of data.data){
						var mus = document.createElement('mus');

						mus.innerHTML =`
											
											<div id="${item.id}" class="act-coo"> 
												
												<div class="coo-left">
													<img src="${imagePrefix}${item.img_url}" alt="">
												</div>
												
												<div class="coo-right">
													<p><b>${item.title}</b></p>
													<p class="active">评论:${item.like_count}</p>
													<p>专辑:${item.album}</p>
													<p>作者:${item.author_name}</p>
												</div>
												
												
											</div>
											`
											;

						$(".select-content .active_1").eq(1).append(mus);
					}
					pageCount = Math.ceil(data.total / count)
					//分页器
					$('#box-music').paging({
						initPageNo: currentPage, // 初始页码
						totalPages: pageCount, //总页数
						slideSpeed: 600, // 缓动速度。单位毫秒
						// jump: true, //是否支持跳转
						callback: function(page) { // 回调函数
							// var start = (this.page-1)*this.count
							console.log(page)
							if(currentPage == page){
								return
							}
							downMusicList(page);
						}
					});
					//绑定id。跳转详情页面
					$(".act-coo").click(function(e){
						var id=e.currentTarget.id
						sessionStorage.id=id
						location.href="musicDetail.html"
					})
				}
			});
			
		}

		downMusicList(currentPage)




		
		//ajax请求-影视-数据
		var currentPage = 1;
		var pageCount = 0;
		var count =16;
		function  downMovieList(page){
			currentPage = page
			var user = JSON.parse(localStorage.user)
			console.log(user)
			var url=getFavoriteUrl+"&userId="+user.id+"&type="+5+"&token="+localStorage.token+"&start="+(currentPage-1)*count+"&count="+count;

			
			$.ajax({
				dataType:"json",
				url:url,
				success:function(data){
					
					$(".select-content .movie").eq(0).empty()
					for(item of data.data){
						var mov = document.createElement('mov');

						mov.innerHTML =`
											
											<div id="${item.id}" class="movie-content">
												
													<img src="${imagePrefix}${item.img_url}" alt="">
													<div class="zi">《${item.subtitle}》</div>
												
													
											</div>
											
										
										`;

						$(".select-content .movie").eq(0).append(mov);
					}
					pageCount = Math.ceil(data.total / count)
					//分页器
					$('#box-movie').paging({
						initPageNo: currentPage, // 初始页码
						totalPages: pageCount, //总页数
						slideSpeed: 600, // 缓动速度。单位毫秒
						// jump: true, //是否支持跳转
						callback: function(page) { // 回调函数
							// var start = (this.page-1)*this.count
							console.log(page)
							if(currentPage == page){
								return
							}
							downMovieList(page);
						}
					});
					//绑定id。跳转详情页面
					$(".movie-content").click(function(e){
						var id=e.currentTarget.id
						sessionStorage.id=id
						location.href="movieDetail.html"
					})
				}
			});
			
		}

		downMovieList(currentPage)


		//获取最佳文章
		function  downrankList(){
			var xhr = new XMLHttpRequest();
			var url=rankingListUrl+"&count="+3;
			// console.log(url)
			$.ajax({
				dataType:"json",
				url:url,
				success:function(data){
					// console.log(data)
					$(".content-right-bottom .content-first").eq(0).empty()
					for(item of data.data){
						
						for (var i of item) {
							var rank = document.createElement('rank');
							// console.log(i)
							rank.innerHTML =`
											
											<div class="content-first">
												
													<div class="content-first-left">
														<img src="${imagePrefix}${i.img_url}" alt="">
													</div>
													<div class="content-first-right">
														<p>${i.title}</p>
														<p><i>${i.post_date}</i></p>
													</div>
												
												
											</div>
											
											`;

							$(".content-right-bottom .content-first").eq(0).append(rank);
						}
					}
				}
			});
			
		}

		downrankList()
		</script>
</body>
</html>